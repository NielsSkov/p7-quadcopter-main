clear
clc
close all

L = [-60,-70,-80];
B1 = [         0,   -0.2396,         0,    0.2396];
B2 = [    0.2396,         0,   -0.2396,         0];
B3 = [    0.0377,   -0.0377,    0.0377,   -0.0377];
F1 = [    5.3502, -158.0807, -565.6517,    0.4838,  -32.4068, -108.4678,];
F2 = [  178.7581,  -17.3017,  570.1042,   34.2759,   -1.5603,  108.8655];
F3 = [  6.7933,  193.6623, -576.7799,    0.5265,   35.5396, -109.4479];
F4 = [ -190.9017,  -18.2798,  572.3275,  -35.2862,   -1.5725,  109.0503];
Fint1 = [  14.2039, -246.1343, -952.8766];
Fint2 = [  300.5581,  -45.6192,  964.6692];
Fint3 = [   19.7311,  341.4279, -982.6710];
Fint4 = [ -334.4931,  -49.6744,  970.8784];

u_k1 = [0.0, 0.0, 0.0, 0.0];
y_k = [-0.01, 0.0, 0.0];
y_k1 = [0.0, 0.0, 0.0];
r_k1 = [0.0, 0.0, 0.0];
r_k = [0.0, 0.0, 0.0];
x2_k1 = [0.0, 0.0, 0.0];

for i=1:1:1
    x_intk = [ 0.0, 0.0, 0.0 ];
    x2_k = [ 0.0, 0.0, 0.0 ];

	for j=1:1:3
		x_intk(j) = y_k1(j) - r_k1(j);
		switch j
			case 1
				x2_k(i) = L(i) * x2_k1(i) + B1(1) * u_k1(1) + B1(2) * u_k1(2) + B1(3) * u_k1(3) + B1(4) * u_k1(4) - L(i) * y_k(i);
			case 2
                x2_k(i) = L(i) * x2_k1(i) + B2(1) * u_k1(1) + B2(2) * u_k1(2) + B2(3) * u_k1(3) + B2(4) * u_k1(4) - L(i) * y_k(i);
			case 3
                x2_k(i) = L(i) * x2_k1(i) + B3(1) * u_k1(1) + B3(2) * u_k1(2) + B3(3) * u_k1(3) + B3(4) * u_k1(4) - L(i) * y_k(i);
        end	
    end

    for k=1:1:4
		switch k
		case 1
			u_k1(k) = F1(1) * y_k(1) + F1(2) * y_k(2) + F1(3) * y_k(3) + F1(4) * x2_k(1) + F1(5) * x2_k(2) + F1(6) * x2_k(3) + Fint1(1) * x_intk(1) + Fint1(2) * x_intk(2) + Fint1(3) * x_intk(3);
		case 2
            u_k1(k) = F2(1) * y_k(1) + F2(2) * y_k(2) + F2(3) * y_k(3) + F2(4) * x2_k(1) + F2(5) * x2_k(2) + F2(6) * x2_k(3) + Fint2(1) * x_intk(1) + Fint2(2) * x_intk(2) + Fint2(3) * x_intk(3);
		case 3
            u_k1(k) = F3(1) * y_k(1) + F3(2) * y_k(2) + F3(3) * y_k(3) + F3(4) * x2_k(1) + F3(5) * x2_k(2) + F3(6) * x2_k(3) + Fint3(1) * x_intk(1) + Fint3(2) * x_intk(2) + Fint3(3) * x_intk(3);
		case 4
            u_k1(k) = F4(1) * y_k(1) + F4(2) * y_k(2) + F4(3) * y_k(3) + F4(4) * x2_k(1) + F4(5) * x2_k(2) + F4(6) * x2_k(3) + Fint4(1) * x_intk(1) + Fint4(2) * x_intk(2) + Fint4(3) * x_intk(3);
        end
    end

	y_k1(1) = y_k(1);
	y_k1(2) = y_k(2);
	y_k1(3) = y_k(3);
	r_k1(1) = r_k(1);
	r_k1(2) = r_k(2);
	r_k1(3) = r_k(3);
	x2_k1(1) = x2_k(1);
	x2_k1(2) = x2_k(2);
	x2_k1(3) = x2_k(3);
    
end